(function(t){function e(e){for(var s,o,a=e[0],c=e[1],l=e[2],u=0,d=[];u<a.length;u++)o=a[u],n[o]&&d.push(n[o][0]),n[o]=0;for(s in c)Object.prototype.hasOwnProperty.call(c,s)&&(t[s]=c[s]);h&&h(e);while(d.length)d.shift()();return r.push.apply(r,l||[]),i()}function i(){for(var t,e=0;e<r.length;e++){for(var i=r[e],s=!0,a=1;a<i.length;a++){var c=i[a];0!==n[c]&&(s=!1)}s&&(r.splice(e--,1),t=o(o.s=i[0]))}return t}var s={},n={app:0},r=[];function o(e){if(s[e])return s[e].exports;var i=s[e]={i:e,l:!1,exports:{}};return t[e].call(i.exports,i,i.exports,o),i.l=!0,i.exports}o.m=t,o.c=s,o.d=function(t,e,i){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(o.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)o.d(i,s,function(e){return t[e]}.bind(null,s));return i},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],c=a.push.bind(a);a.push=e,a=a.slice();for(var l=0;l<a.length;l++)e(a[l]);var h=c;r.push([0,"chunk-vendors"]),i()})({0:function(t,e,i){t.exports=i("56d7")},"034f":function(t,e,i){"use strict";var s=i("64a9"),n=i.n(s);n.a},"0d8e":function(t,e,i){"use strict";var s=i("2b1d"),n=i.n(s);n.a},"11ca":function(t,e,i){t.exports=i.p+"img/eraser.e9a8fd01.svg"},"162a":function(t,e,i){"use strict";var s=i("5d40"),n=i.n(s);n.a},1948:function(t,e,i){},"2b1d":function(t,e,i){},"2cbb":function(t,e,i){},"305b":function(t,e,i){"use strict";var s=i("bd5f"),n=i.n(s);n.a},"383d":function(t,e,i){},"45f8":function(t,e,i){},"4c43":function(t,e,i){"use strict";var s=i("383d"),n=i.n(s);n.a},"56d7":function(t,e,i){"use strict";i.r(e);var s=i("2b0e"),n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{staticClass:"view"},[i("div",{staticClass:"navigation"},[i("span",{directives:[{name:"show",rawName:"v-show",value:!t.authenticated,expression:"!authenticated"}]},[i("router-link",{attrs:{to:"/"}},[t._v("Inkplain")]),i("router-link",{attrs:{to:"/about"}},[t._v("About")])],1),i("span",{directives:[{name:"show",rawName:"v-show",value:t.authenticated,expression:"authenticated"}]},[i("router-link",{attrs:{to:"/manage"}},[t._v("Video Manager")]),i("router-link",{attrs:{to:"/record"}},[t._v("Record")])],1),i("router-link",{attrs:{to:"/play"}},[t._v("Videos")]),i("span",{directives:[{name:"show",rawName:"v-show",value:t.authenticated,expression:"authenticated"}],staticClass:"right"},[i("span",{staticClass:"router-link",on:{click:function(e){return t.logout()}}},[t._v("Log out")])])],1),i("router-view")],1)])},r=[];const o=i("bc3a");var a={name:"app",data:function(){return{authenticated:!1}},methods:{logout:function(){o.get("api/logout",{withCredentials:!0}).then(t=>{t.data.success&&this.$router.push({name:"home"})})}},watch:{$route(t,e){console.log("route change"),o.get("api/user/",{withCredentials:!0}).then(t=>{this.authenticated=void 0!=t.data.email})}},mounted:function(){o.get("api/user/",{withCredentials:!0}).then(t=>{this.authenticated=void 0!=t.data.email})}},c=a,l=(i("034f"),i("2877")),h=Object(l["a"])(c,n,r,!1,null,null,null),u=h.exports,d=i("8c4f"),p=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"home"},[s("div",{staticClass:"hero"},[s("h1",[t._v("\n\t\t\tCreate annotation videos online \n\t\t")]),s("img",{attrs:{src:i("d17b"),alt:"",title:"Screenshot of Annotati",width:"600"}}),s("p",{staticClass:"basicInfo"},[t._v("\n\t\t\tUse your stylus to write on top of questions, a blank canvas, or documents.\n\t\t\tWhen you are finished, click publish and share your video link.\n\t\t")]),s("div",{staticClass:"form"},[s("h2",[t._v("Sign up for free")]),s("table",[s("tr",[t._m(0),s("td",[s("input",{directives:[{name:"model",rawName:"v-model",value:t.email,expression:"email"}],attrs:{type:"email",placeholder:"Enter your email address",id:"email"},domProps:{value:t.email},on:{input:[function(e){e.target.composing||(t.email=e.target.value)},function(e){t.errorMessage=""}]}})])]),s("tr",[t._m(1),s("td",[s("input",{directives:[{name:"model",rawName:"v-model",value:t.password,expression:"password"}],attrs:{type:"password",placeholder:"Set a password",id:"password"},domProps:{value:t.password},on:{input:function(e){e.target.composing||(t.password=e.target.value)}}})])])]),""!=t.errorMessage?s("div",{staticClass:"error"},[t._v(t._s(t.errorMessage))]):t._e(),s("br"),s("div",{staticClass:"register button",on:{click:function(e){return t.signup()}}},[t._v("Create account")])]),s("div",[s("h2",[t._v("\n\t\t\t\tHave an account?\n\t\t\t")]),s("div",{staticClass:"button",on:{click:function(e){return t.login()}}},[t._v("Login")])])])])},v=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("td",[i("label",{attrs:{for:"email"}},[t._v("Email:")])])},function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("td",[i("label",{attrs:{for:"password"}},[t._v("Password:")])])}];const g=i("bc3a");var m={name:"home",data:function(){return{email:"",password:"",errorMessage:""}},methods:{signup:function(){var t={email:this.email,password:this.password};""!=this.email&&""!=this.password?this.password.length<6?this.errorMessage="Please choose a longer password.":g.post("api/user",t).then(function(t){t.data.success?this.$router.push({name:"manage"}):this.errorMessage="That email already has an account."}.bind(this)):this.errorMessage="Please complete the form."},login:function(){this.$router.push({name:"login"})}}},f=m,b=(i("cccb"),Object(l["a"])(f,p,v,!1,null,null,null)),y=b.exports,w=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"home"},[i("div",{staticClass:"hero"},[i("div",{staticClass:"form"},[i("h2",[t._v("Login to Annotati")]),i("table",[i("tr",[t._m(0),i("td",[i("input",{directives:[{name:"model",rawName:"v-model",value:t.email,expression:"email"}],attrs:{type:"email",placeholder:"Enter email address",id:"email"},domProps:{value:t.email},on:{input:[function(e){e.target.composing||(t.email=e.target.value)},function(e){t.errorMessage=""}]}})])]),i("tr",[t._m(1),i("td",[i("input",{directives:[{name:"model",rawName:"v-model",value:t.password,expression:"password"}],attrs:{type:"password",placeholder:"Enter password",id:"password"},domProps:{value:t.password},on:{input:function(e){e.target.composing||(t.password=e.target.value)}}})])])]),""!=t.errorMessage?i("div",{staticClass:"error"},[t._v(t._s(t.errorMessage))]):t._e(),i("br"),i("div",{staticClass:"register button",on:{click:function(e){return t.login()}}},[t._v("Login to Annotati")])]),i("div",[i("h2",[t._v("\n\t\t\t\tNeed an account?\n\t\t\t")]),i("div",{staticClass:"button",on:{click:function(e){return t.signup()}}},[t._v("Sign up")])])])])},k=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("td",[i("label",{attrs:{for:"email"}},[t._v("Email:")])])},function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("td",[i("label",{attrs:{for:"password"}},[t._v("Password:")])])}];const C=i("bc3a");var _={name:"home",data:function(){return{email:"",password:"",errorMessage:""}},methods:{signup:function(){this.$router.push({name:"home"})},login:function(){var t={email:this.email,password:this.password};""!=this.email&&""!=this.password?C.post("api/login",t,{withCredentials:!0}).then(function(t){t.data.success?this.$router.push({name:"manage"}):this.errorMessage="Failed to login."}.bind(this)):this.errorMessage="Please complete the form."}}},x=_,T=(i("d6db"),Object(l["a"])(x,w,k,!1,null,null,null)),S=T.exports,$=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("div",{staticClass:"recordingSection left"},[i("annotation-canvas",{attrs:{bus:t.bus,recording:t.recording,micActive:t.micActive}})],1),i("div",{staticClass:"recordingSection right"},[i("annotation-tools",{attrs:{recording:t.recording},on:{toggleMic:t.toggleMic,toggleRec:t.toggleRec,colourPick:t.changeColour,clearCanvas:t.clearCanvas,toolSelect:t.toolSelect,brushWidth:t.brushWidth}})],1),!t.recording&&t.initialRecord?i("div",{staticClass:"publishSection"},[i("div",{staticClass:"publishPanel"},[i("h1",[t._v("Publish")]),i("input",{directives:[{name:"model",rawName:"v-model",value:t.title,expression:"title"}],attrs:{type:"text",placeholder:"Video Title"},domProps:{value:t.title},on:{input:function(e){e.target.composing||(t.title=e.target.value)}}}),i("br"),i("textarea",{directives:[{name:"model",rawName:"v-model",value:t.description,expression:"description"}],attrs:{id:"",name:"",cols:"70",rows:"3",placeholder:"Video Description"},domProps:{value:t.description},on:{input:function(e){e.target.composing||(t.description=e.target.value)}}}),i("br"),i("button",{staticClass:"tool-button",on:{click:t.save}},[t._v("Publish")]),t.published?i("div",[i("span",[t._v("Accessible at ")]),i("a",{attrs:{href:""}},[t._v("annotatii.com/play/"+t._s(t.publishId))])]):t._e()])]):t._e()])},E=[],L=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"tool-container"},[i("span",{staticClass:"button tool-button",class:{active:"pen"==t.activeTool},on:{click:function(e){return t.toolSelect("pen")}}},[i("object",{ref:"pen",staticClass:"toolImage",attrs:{data:t.penSvg,type:"image/svg+xml"}})]),i("span",{staticClass:"button tool-button",class:{active:"highlighter"==t.activeTool},on:{click:function(e){return t.toolSelect("highlighter")}}},[i("object",{ref:"highlighter",staticClass:"toolImage",attrs:{data:t.highlighterSvg,type:"image/svg+xml"}})]),i("span",{staticClass:"button tool-button",class:{active:"eraser"==t.activeTool},on:{click:function(e){return t.toolSelect("eraser")}}},[i("object",{staticClass:"toolImage",attrs:{data:t.eraserSvg,type:"image/svg+xml"}})]),i("span",{staticClass:"button tool-button",on:{click:function(e){return t.clearCanvas()}}},[t._v("Clear")]),i("span",{staticClass:"button tool-button",class:{recording:t.recording},on:{click:t.toggleRecording}},[t._v(t._s(t.recording?"Recording":"Record"))]),i("span",{staticClass:"button tool-button",class:{blue:t.micActive},on:{click:t.toggleMicrophone}},[t._v(t._s(t.micActive?"Mic On":"Mic Off"))]),i("colour-picker",{on:{colourPick:t.colourPick}}),i("span",{staticClass:"button tool-button"},[i("span",[t._v("\n\t\t\tThickness\n\t\t")]),i("input",{staticClass:"thicknessSlider",attrs:{type:"range",min:"1",max:"30",value:"2"},on:{change:t.brushWidth,input:t.brushWidthVisualPreview}})])],1)},P=[],D=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"palette"},t._l(t.colours,function(e){return i("span",{staticClass:"colour-swatch",style:{backgroundColor:e},on:{click:function(i){return t.colourPick(e)}}})}),0)},M=[],R={name:"colour-picker",data:function(){return{colours:["#333333","#63BBEE","#92E285","#ef5656","#F09E6F","#DC85E9","#F5CE53","#a07b86"]}},methods:{colourPick:function(t){this.$emit("colourPick",t)}}},O=R,A=(i("4c43"),Object(l["a"])(O,D,M,!1,null,"e2c0eed6",null)),N=A.exports,j={name:"annotation-tools",components:{ColourPicker:N},data:function(){return{activeTool:"pen",highlighterSvg:i("f731"),penSvg:i("c4cc"),eraserSvg:i("11ca")}},props:["recording","micActive"],methods:{setToolsColour:function(t){this.$refs["pen"].getSVGDocument().getElementById("penEnd").style.fill=t,this.$refs["pen"].getSVGDocument().getElementById("penLine").style.stroke=t,this.$refs["highlighter"].getSVGDocument().getElementById("highlighterEnd").style.fill=t,this.$refs["highlighter"].getSVGDocument().getElementById("highlighterLine").style.stroke=t},colourPick:function(t){this.setToolsColour(t),this.$emit("colourPick",t)},toggleRecording:function(){this.$emit("toggleRec")},toggleMicrophone:function(){this.$emit("toggleMic")},toolSelect:function(t){this.activeTool=t,this.$emit("toolSelect",t)},clearCanvas:function(){this.$emit("clearCanvas")},brushWidthVisualPreview:function(t){this.$refs["pen"].getSVGDocument().getElementById("penLine").style["stroke-width"]=t.target.value/4,this.$refs["highlighter"].getSVGDocument().getElementById("highlighterLine").style["stroke-width"]=t.target.value/4},brushWidth:function(t){this.$emit("brushWidth",t.target.value)}}},I=j,W=(i("0d8e"),Object(l["a"])(I,L,P,!1,null,null,null)),V=W.exports,U=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{ref:"player",staticClass:"boardContainer",on:{mouseup:function(e){t.scrubbing=!1},mousemove:t.handleScrub}},[i("canvas",{ref:"board"}),i("div",{directives:[{name:"show",rawName:"v-show",value:!t.recording&&t.initialRecord,expression:"!recording && initialRecord"}]},[void 0!=this.annotationLogic.playback?i("div",{staticClass:"playControls unselectable"},[i("span",{directives:[{name:"show",rawName:"v-show",value:t.playing,expression:"playing"}],on:{click:t.playToggle}},[i("svg",{attrs:{id:"i-play",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",width:"32",height:"32",fill:"none",stroke:"currentcolor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2"}},[i("path",{attrs:{d:"M10 2 L10 30 24 16 Z"}})])]),i("span",{directives:[{name:"show",rawName:"v-show",value:!t.playing,expression:"!playing"}],on:{click:t.playToggle}},[i("svg",{attrs:{id:"i-pause",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",width:"32",height:"32",fill:"none",stroke:"currentcolor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2"}},[i("path",{attrs:{d:"M23 2 L23 30 M9 2 L9 30"}})])]),i("span",{staticClass:"time"},[t._v("\n\t\t\t\t"+t._s(t.humanTime(this.annotationLogic.playback.time).mins)+":"+t._s(t.humanTime(this.annotationLogic.playback.time).secs)+"\n\t\t\t\t/\n\t\t\t\t"+t._s(t.humanTime(this.annotationLogic.playback.lengthTime).mins)+":"+t._s(t.humanTime(this.annotationLogic.playback.lengthTime).secs)+"\n\t\t\t")])]):t._e(),i("audio",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"recordedAudio",staticClass:"slider",attrs:{src:"",controls:""}}),i("div",{ref:"scrubber",staticClass:"scrubber",on:{mousedown:function(e){t.scrubbing=!0,t.handleScrub(e)}}},[i("span",{ref:"progress",staticClass:"progress"})]),i("span",{on:{click:t.fullscreen}},[i("svg",{attrs:{id:"i-fullscreen",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",width:"32",height:"32",fill:"none",stroke:"currentcolor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2"}},[i("path",{attrs:{d:"M4 12 L4 4 12 4 M20 4 L28 4 28 12 M4 20 L4 28 12 28 M28 20 L28 28 20 28"}})])])])])},B=[];function J(){return this.recordStore=[],this.recording=!1,this.startTime=0,this.recordingLength=0,this.startRecording=function(){this.recording=!0,this.recordStore=[],this.startTime=(new Date).getTime()},this.eventType={clear:1,down:2,up:3,move:4,brush:5,enter:6,leave:7},this.eventTypes={1:["time"],2:["time"],3:["time"],4:["time","x","y"],5:["time","colour","width","opacity"],6:["time"],7:["time"]},this.maxEventSize=Math.pow(4,64),this.encodeEvent=function(t,...e){if(this.eventTypes[t].length!=e.length)throw"attemped to store event with invalid number of arguments";for(var i=0;i<e.length;i++)if(e[i]>this.maxEventSize)throw`Tried to store data greater than 4 bytes (value ${e[i]}) in event ${t}`;this.recordStore.push(t),this.recordStore.push(...e)},this.record=function(t){if(this.recording)switch(t.time=(new Date).getTime()-this.startTime,this.recordingLength=t.time,t.type){case this.eventType.clear:this.encodeEvent(t.type,t.time);break;case this.eventType.up:this.encodeEvent(t.type,t.time);break;case this.eventType.down:this.encodeEvent(t.type,t.time);break;case this.eventType.move:this.encodeEvent(t.type,t.time,t.coords.x,t.coords.y);break;case this.eventType.brush:this.encodeEvent(t.type,t.time,t.brush.colour,t.brush.thickness,t.brush.opacity);break;case this.eventType.enter:this.encodeEvent(t.type,t.time);break;case this.eventType.leave:this.encodeEvent(t.type,t.time);break;default:console.log(t)}},this.stopRecording=function(){this.recording=!1,this.recordStore.length>0&&(this.recordingLength=this.recordStore[this.recordStore.length-1].time)},this}function F(t){this.canvas=t,this.ctx=this.canvas.getContext("2d",{desynchronized:!0,alpha:!1}),this.currentPos={x:0,y:0},this.previousPos={x:0,y:0},this.down=!1,this.inCanvas=!1,this.brush={thickness:2,colour:"black",opacity:1};var e=new Image;return e.src="bg.png",this.clear=function(){this.ctx.globalAlpha=1,this.ctx.fillStyle="white",this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),this.ctx.fillStyle="black",this.ctx.lineJoin="round",this.ctx.lineCap="round",this.currentPos={x:0,y:0},this.previousPos={x:0,y:0},this.down=!1,this.inCanvas=!1,this.startedDrawing=!1},this.clear(),this.move=function(t,e){this.previousPos.x=this.currentPos.x,this.previousPos.y=this.currentPos.y,this.currentPos.x=t,this.currentPos.y=e,this.startedDrawing&&(this.startedDrawing=!1,this.ctx.moveTo(t,e)),this.down&&(this.ctx.lineWidth=this.brush.thickness,this.ctx.strokeStyle=this.brush.colour,this.ctx.lineTo(this.currentPos.x,this.currentPos.y))},this.penUp=function(){this.down=!1,this.ctx.stroke()},this.penDown=function(){this.down=!0,this.ctx.beginPath(),this.startedDrawing=!0},this.penEnter=function(){this.inCanvas=!0},this.penLeave=function(){this.inCanvas=!1},this.draw=function(){this.ctx.beginPath(),this.ctx.moveTo(this.previousPos.x,this.previousPos.y),this.ctx.lineTo(this.currentPos.x,this.currentPos.y),this.ctx.stroke()},this.drawPointer=function(){this.inCanvas&&(this.ctx.globalAlpha=1,this.ctx.beginPath(),this.ctx.lineWidth=2,this.ctx.arc(this.currentPos.x,this.currentPos.y,this.brush.thickness,0,2*Math.PI),this.ctx.stroke())},this.brushLoad=function(){this.ctx.lineWidth=this.brush.thickness,this.ctx.strokeStyle=this.brush.colour,this.ctx.globalAlpha=this.brush.opacity},this}function H(t){return this.activateAudio=function(){navigator.mediaDevices.getUserMedia({audio:!0}).then(t=>{this.handlerFunction(t)})},this.handlerFunction=function(e){this.rec=new MediaRecorder(e),this.rec.ondataavailable=e=>{if(this.audioChunks.push(e.data),"inactive"==this.rec.state){let e=new Blob(this.audioChunks,{type:"audio/mpeg-3"});t.src=URL.createObjectURL(e),t.controls=!0,t.autoplay=!0,this.sendData(e)}}},this.sendData=function(t){},this.startRecordingAudio=function(){this.audioChunks=[],this.rec.start()},this.stopRecordingAudio=function(){void 0!=this.rec&&this.rec.stop()},this}i("bc3a");function G(t,e,i){this.colours={black:0,white:1},this.colourLUT=["black","white","#333333","#63BBEE","#92E285","#ef5656","#F09E6F","#DC85E9","#F5CE53","#a07b86"],this.brush={thickness:2,colour:this.colours.black,opacity:1},this.storedInkColour=this.colours.black,this.inCanvas=!1,this.eventTypes={clear:1,down:2,up:3,moving:4,brush:5,enter:6,leave:7},this.playback={time:0,lengthTime:0,progress:0,playing:!1},this.recordAudio=!1,this.recorder=new J,this.renderer=new F(t),this.audioManager=new H(e),this.canvas=this.renderer.canvas,t.addEventListener("pointermove",function(e){if(!this.recorder.recording)return;const i=t.getBoundingClientRect(),s=e.getCoalescedEvents();s.forEach(e=>{let s={type:this.eventTypes.moving,coords:{x:Math.round((e.clientX-i.left)/t.clientWidth*1920),y:Math.round((e.clientY-i.top)/t.clientHeight*1080)}};this.recorder.record(s),this.playRecord(s)}),e.preventDefault()}.bind(this)),t.addEventListener("touchmove",function(e){if(!this.recorder.recording)return;const i=t.getBoundingClientRect();let s={type:this.eventTypes.moving,coords:{x:Math.round((e.targetTouches[0].clientX-i.left)/t.clientWidth*1920),y:Math.round((e.targetTouches[0].clientY-i.top)/t.clientHeight*1080)}};this.recorder.record(s),this.playRecord(s),e.preventDefault()}.bind(this)),t.addEventListener("touchstart",function(t){let e={type:this.eventTypes.down};this.playRecord(e),this.recorder.record(e),t.preventDefault()}.bind(this)),t.addEventListener("touchend",function(t){let e={type:this.eventTypes.up};this.playRecord(e),this.recorder.record(e),t.preventDefault()}.bind(this)),t.addEventListener("touchcancel",function(t){let e={type:this.eventTypes.up};this.playRecord(e),this.recorder.record(e),t.preventDefault()}.bind(this)),t.addEventListener("pointerdown",function(e){let i={type:this.eventTypes.down};this.playRecord(i),this.recorder.record(i);const s=t.getBoundingClientRect();let n={type:this.eventTypes.moving,coords:{x:Math.round((e.clientX-s.left)/t.clientWidth*1920),y:Math.round((e.clientY-s.top)/t.clientHeight*1080)}};this.recorder.record(n),this.playRecord(n),e.preventDefault()}.bind(this)),t.addEventListener("pointerup",function(t){let e={type:this.eventTypes.up};this.playRecord(e),this.recorder.record(e),t.preventDefault()}.bind(this)),t.addEventListener("mouseout",function(t){let e={type:this.eventTypes.up};this.playRecord(e),this.recorder.record(e),this.recorder.record({type:this.eventTypes.leave}),t.preventDefault()}.bind(this)),t.addEventListener("mouseenter",function(t){let e={type:this.eventTypes.brush,brush:JSON.parse(JSON.stringify(this.brush))};this.playRecord(e),this.recorder.record(e),this.recorder.record({type:this.eventTypes.enter}),t.preventDefault()}.bind(this)),this.brushColour=function(t){this.brush.colour=t,this.storedInkColour=this.brush.colour},this.brushColourWithLookup=function(t){this.brushColour(this.colourLUT.indexOf(t))},this.brushWidth=function(t){this.brush.thickness=t},this.clearCanvas=function(){let t={type:this.eventTypes.clear};this.playRecord(t),this.recorder.record(t)},this.toolSelect=function(t){"eraser"==t&&(this.storedInkColour=this.brush.colour,this.brush.colour=this.colours.white,this.brush.thickness=40,this.brush.opacity=1),"highlighter"==t&&(this.brush.colour=this.storedInkColour,this.brush.thickness=15,this.brush.opacity=.4),"pen"==t&&(this.brush.colour=this.storedInkColour,this.brush.thickness=2,this.brush.opacity=1)},this.takeSnap=function(){var e=document.createElement("canvas"),i=e.getContext("2d");e.width=t.width,e.height=t.height,i.drawImage(t,0,0)},this.recToggle=function(){if(this.recorder.recording)this.playback.lengthTime=this.recorder.recordingLength,this.audioManager.stopRecordingAudio(),this.recorder.stopRecording();else{this.renderer.clear(),this.recorder.startRecording(),this.storedInkColour=this.brush.colour,this.recordAudio&&this.audioManager.startRecordingAudio();let t={type:this.eventTypes.brush,brush:JSON.parse(JSON.stringify(this.brush))};this.recorder.record(JSON.parse(JSON.stringify(t))),this.playRecord(t)}},this.micToggle=function(){this.recordAudio=!this.recordAudio,this.recordAudio&&this.audioManager.activateAudio()},this.playToggle=function(){this.playback.playing=!this.playback.playing,this.playback.playing&&1==this.playback.progress&&(this.playback.time=0)},this.setPlayProgress=function(t){this.playback.time=this.playback.lengthTime*t},this.save=function(t,e){let i={title:t,description:e,lengthTime:this.playback.lengthTime,eventData:this.recorder.recordStore};this.exportVideo(i)},this.exportVideo=new function(t){},this.load=function(t){this.recorder.recordStore=t.eventData,this.playback.lengthTime=t.lengthTime,this.recorder.recordingLength=t.lengthTime,this.playback.time=0,this.recorder.recording=!1},this.renderVideo=function(t,e){this.renderer.clear(),this.playEventRecursive(t,0,e),this.renderer.down&&this.renderer.penUp()};let s=0;this.playEventRecursive=function(t,e,i){switch(t[e]){case this.eventTypes.moving:s=4,this.renderer.move(t[e+2],t[e+3]);break;case this.eventTypes.clear:this.renderer.clear(),s=2;break;case this.eventTypes.up:s=2,this.renderer.penUp();break;case this.eventTypes.down:s=2,this.renderer.penDown();break;case this.eventTypes.brush:{let i={};i.colour=t[e+2],i.thickness=t[e+3],i.opacity=t[e+4],this.renderer.brush=JSON.parse(JSON.stringify(i)),this.renderer.brush.colour=this.colourLUT[i.colour],this.renderer.brushLoad(),s=5;break}case this.eventTypes.enter:this.renderer.penEnter(),s=2;break;case this.eventTypes.leave:this.renderer.penLeave(),s=2;break;default:s=1;break}e<t.length-2&&t[e+1]<i&&this.playEventRecursive(t,e+s,i)}.bind(this),this.playRecord=function(t){t.type==this.eventTypes.moving&&(this.renderer.move(t.coords.x,t.coords.y),this.renderer.down&&this.recorder.recording&&this.renderer.draw()),t.type==this.eventTypes.down&&this.renderer.penDown(),t.type==this.eventTypes.up&&this.renderer.penUp(),t.type==this.eventTypes.brush&&(this.renderer.brush=JSON.parse(JSON.stringify(t.brush)),this.renderer.brush.colour=this.colourLUT[t.brush.colour],this.renderer.brushLoad()),t.type==this.eventTypes.clear&&this.renderer.clear()};var n=Date.now();return this.drawframe=function(){let t=Date.now()-n;n=Date.now(),this.recorder.recording?this.playback.time=0:(this.renderer.clear(),0!=this.recorder.recordStore.length&&(this.renderVideo(this.recorder.recordStore,this.playback.time),this.renderer.drawPointer()),this.playback.playing&&this.playback.time<this.playback.lengthTime&&(this.playback.time+=t),this.playback.time>=this.playback.lengthTime&&(this.playback.time=this.playback.lengthTime,this.playback.playing),this.playback.progress=this.playback.time/this.playback.lengthTime,i.style.width=100*this.playback.progress+"%"),requestAnimationFrame(this.drawframe)}.bind(this),this.drawframe(),this}var Q={name:"annotation-canvas",data(){return{initialRecord:!1,playing:!0,playback:{},progress:0,scubbing:!1,annotationLogic:{},canvas:void 0}},props:["bus","recording"],methods:{playToggle:function(){this.annotationLogic.playToggle(),this.playing=!this.playing},handleScrub:function(t){if(this.scrubbing){const e=this.$refs.scrubber.getBoundingClientRect();this.annotationLogic.setPlayProgress((t.clientX-e.left)/this.$refs.scrubber.clientWidth)}},humanTime:function(t){var e=t/1e3,i=(Math.floor(e/3600),Math.floor(e/60)%60);e=Math.floor(e%60);return{mins:(i<10?"0":"")+i,secs:(e<10?"0":"")+e}},fullscreen:function(){this.$refs["player"].mozRequestFullScreen()}},mounted:function(){this.context=this.$refs["board"].getContext("2d"),this.$refs["board"].width=1920,this.$refs["board"].height=1080,this.annotationLogic=new G(this.$refs["board"],this.$refs["recordedAudio"],this.$refs["progress"]),this.annotationLogic.exportVideo=t=>{this.bus.$emit("publish",t)},this.recording=this.annotationLogic.recorder.recording,this.bus.$on("recToggle",()=>{this.initialRecord=!0,this.annotationLogic.recToggle()}),this.bus.$on("micToggle",()=>{this.annotationLogic.micToggle()}),this.bus.$on("toolSelect",t=>{this.annotationLogic.toolSelect(t)}),this.bus.$on("colourPick",t=>{this.annotationLogic.brushColourWithLookup(t)}),this.bus.$on("clearCanvas",()=>{this.annotationLogic.clearCanvas()}),this.bus.$on("brushWidth",t=>{this.annotationLogic.brushWidth(t)}),this.bus.$on("save",(t,e)=>{this.annotationLogic.save(t,e)}),this.bus.$on("load",t=>{this.annotationLogic.load(t)}),this.bus.$on("enablePlayback",()=>{this.initialRecord=!0})}},q=Q,z=(i("162a"),Object(l["a"])(q,U,B,!1,null,null,null)),X=z.exports;const Y=i("bc3a");var Z={name:"home",components:{AnnotationTools:V,AnnotationCanvas:X},data:function(){return{bus:new s["a"],recording:!1,micActive:!1,initialRecord:!1,title:"",description:"",published:!1,publishId:""}},methods:{changeColour:function(t){this.bus.$emit("colourPick",t)},toggleRec:function(){this.bus.$emit("recToggle"),this.recording=!this.recording,this.initialRecord=!0},toggleMic:function(){this.bus.$emit("micToggle"),this.micActive=!this.micActive},toolSelect:function(t){this.bus.$emit("toolSelect",t)},clearCanvas:function(){this.bus.$emit("clearCanvas")},brushWidth:function(t){this.bus.$emit("brushWidth",t)},save:function(){this.bus.$emit("save",this.title,this.description)}},mounted:function(){void 0==this.bus&&(this.bus=new s["a"]),this.bus.$on("publish",t=>{Y.post("api/video",t,{withCredentials:!0}).then(t=>{t.data.success&&this.$router.push({name:"playback",params:{id:t.data.id}})})})}},K=Z,tt=(i("8d1e"),Object(l["a"])(K,$,E,!1,null,"51568870",null)),et=tt.exports,it=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"browse"},[i("h1",[t._v("Videos")]),i("div",[i("input",{directives:[{name:"model",rawName:"v-model",value:t.searchQuery,expression:"searchQuery"}],attrs:{type:"text",placeholder:"Search videos"},domProps:{value:t.searchQuery},on:{input:function(e){e.target.composing||(t.searchQuery=e.target.value)}}})]),t._l(t.videos,function(e){return i("div",{directives:[{name:"show",rawName:"v-show",value:t.filter(e),expression:"filter(video)"}],staticClass:"video"},[i("router-link",{attrs:{to:{name:"playback",params:{id:e.id}}}},[t._v(t._s(e.title))]),i("div",{staticClass:"meta",attrs:{title:"Uploaded "+t.fullHumanDate(e.uploadDate)}},[t._v(t._s(new Date(e.uploadDate).toLocaleDateString("en-US")))])],1)})],2)},st=[];const nt=i("bc3a");var rt={name:"videos",components:{},data:function(){return{videos:[],searchQuery:""}},methods:{fullHumanDate:function(t){return new Date(t).toLocaleString("en-AU")},filter:function(t){return-1!=t.title.indexOf(this.searchQuery)}},mounted:function(){nt.get("api/listing/",{withCredentials:!0}).then(function(t){this.videos=t.data}.bind(this))}},ot=rt,at=(i("d60a"),Object(l["a"])(ot,it,st,!1,null,null,null)),ct=at.exports,lt=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},ht=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"about"},[i("h1",[t._v("Inkplain is a cloud platform for creating annotation videos.")]),i("p",[t._v("Inkplain may be ideal for your tutoring or teaching needs. Here are some features.")]),i("ul",[i("li",[t._v("Free. No watermarks or catches.")]),i("li",[t._v("No downloads required.")]),i("li",[t._v("Due to a unique storage method, videos upload and download super fast.")]),i("li",[t._v("Created videos are instantly sharable with a unique link.")])]),i("p",[t._v("Give it a shot!")])])}],ut={},dt=Object(l["a"])(ut,lt,ht,!1,null,null,null),pt=dt.exports,vt=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("h1",[t._v(t._s(t.videoData.title))]),i("div",{staticClass:"recordingSection left"},[i("annotation-canvas",{attrs:{bus:t.bus,recording:!1,micActive:!1}})],1),i("div",{staticClass:"description"},[t._v("\n\t\t"+t._s(t.videoData.description)+"\n\t")])])},gt=[];const mt=new s["a"],ft=i("bc3a");var bt={name:"playback",components:{AnnotationCanvas:X},data:function(){return{bus:mt,videoData:{}}},methods:{},mounted:function(){ft.get(`api/video/${this.$route.params.id}`,{withCredentials:!0}).then(t=>{this.videoData=t.data,mt.$emit("load",t.data),mt.$emit("enablePlayback")})}},yt=bt,wt=(i("305b"),Object(l["a"])(yt,vt,gt,!1,null,"2941f1b6",null)),kt=wt.exports,Ct=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"about"},[i("h2",[t._v("User: "+t._s(t.user.email))]),i("h2",[t._v("Your videos ("+t._s(t.videos.length)+")")]),t._l(t.videos,function(e){return i("div",{staticClass:"video"},[i("router-link",{attrs:{to:{name:"playback",params:{id:e.id}}}},[t._v(t._s(e.title))]),i("div",{staticClass:"meta",attrs:{title:"Uploaded "+t.fullHumanDate(e.uploadDate)}},[t._v(t._s(new Date(e.uploadDate).toLocaleDateString("en-US")))]),i("button",{staticClass:"red button",on:{click:function(i){return t.deleteVideo(e)}}},[t._v("Delete")])],1)})],2)},_t=[];const xt=i("bc3a");var Tt={name:"about",components:{},data:function(){return{user:{},videos:[]}},methods:{fullHumanDate:function(t){return new Date(t).toLocaleString("en-AU")},filter:function(t){return-1!=t.title.indexOf(this.searchQuery)},deleteVideo:function(t){xt.post("api/deletevideo/",t,{withCredentials:!0}).then(e=>{e.data.success&&this.videos.splice(this.videos.indexOf(t),1)})}},mounted:function(){xt.get("api/userlisting/",{withCredentials:!0}).then(t=>{this.videos=t.data}),xt.get("api/user/",{withCredentials:!0}).then(t=>{this.user=t.data})}},St=Tt,$t=(i("84dc"),Object(l["a"])(St,Ct,_t,!1,null,null,null)),Et=$t.exports;const Lt=i("bc3a");s["a"].use(d["a"]);const Pt=new d["a"]({mode:"history",base:"/",routes:[{path:"/",name:"home",component:y},{path:"/login",name:"login",component:S},{path:"/record",name:"recording",meta:{auth:!0},component:et},{path:"/manage/",name:"manage",meta:{auth:!0},component:Et},{path:"/play/",name:"videos",component:ct},{path:"/play/:id",name:"playback",component:kt},{path:"/about",name:"about",component:pt}]});Pt.beforeEach((t,e,i)=>{void 0!=t.meta&&t.meta.auth?Lt.get("api/user/",{withCredentials:!0}).then(function(t){i(0!=t.success&&void 0!=t.data.email&&void 0)}.bind(void 0)):i()});var Dt=Pt;s["a"].config.productionTip=!1,new s["a"]({router:Dt,render:function(t){return t(u)}}).$mount("#app")},"5d40":function(t,e,i){},"64a9":function(t,e,i){},"84dc":function(t,e,i){"use strict";var s=i("1948"),n=i.n(s);n.a},"8d1e":function(t,e,i){"use strict";var s=i("2cbb"),n=i.n(s);n.a},a9e7:function(t,e,i){},bd5f:function(t,e,i){},c4cc:function(t,e,i){t.exports=i.p+"img/pen.af2e6036.svg"},cccb:function(t,e,i){"use strict";var s=i("d563"),n=i.n(s);n.a},d17b:function(t,e,i){t.exports=i.p+"img/screen small.77719512.png"},d563:function(t,e,i){},d60a:function(t,e,i){"use strict";var s=i("45f8"),n=i.n(s);n.a},d6db:function(t,e,i){"use strict";var s=i("a9e7"),n=i.n(s);n.a},f731:function(t,e,i){t.exports=i.p+"img/highlighter.d854581f.svg"}});
//# sourceMappingURL=app.b665df7d.js.map